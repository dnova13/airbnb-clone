{% extends "base.html" %}
{% load last_msg  i18n %}

{% block page_title %}
    Conversation
{% endblock page_title %}

{% block search-bar %}
{% endblock search-bar %}

{% block content %}
     
    <div class="container mx-auto my-10 mt-32 flex justify-between min-h-50vh">
        <div class="border w-1/4 p-10 ">
            <span class="text-center w-full block text-lg font-medium">{% trans "Conversation" %}</span>
            <div class="justify-between mx-auto mt-10 items-center">
                <div class="flex flex-col items-center">
                    {% include "mixins/user_avatar.html" with user=user %}
                    <span class="mt-2 text-gray-500 ">{{user.first_name}}</span>
                </div>
            </div>
        </div>
        <div class="flex-grow">
            <div id="reserv-section" class="conv-scroll border ml-10 p-10 flex flex-col">
                {% for cov in conversation.all  %}
                    {% for participant in cov.participants.all  %}
                        {% if participant.pk != user.pk %}
                            <div class="flax items-center mb-2 p-4 rounded-lg font-light text-lg w-full text-black bg-yellow-200 hover:bg-yellow-100">
                                <a class="flex items-center" href="{% url 'conversations:go' user.pk participant.pk %}">
                                    {% include "mixins/user_avatar.html" with user=participant h_and_w='w-11 h-11' %}           
                                    <div class="ml-5 w-full overflow-hidden">
                                        {% last_msg cov user as last_msg_obj %}
                                        <p class="flex items-center font-bold" >{{participant.first_name}}</p>
                                        <p class="text-sm truncate">{{last_msg_obj.message}}<p>
                                    </div>
                                    {% if last_msg_obj.is_read == False %}
                                        <span class="flex text-right text-sm text-red-500">‚óè</span>
                                    {% endif %}
                                </a>
                            </div>
                        {% endif %}
                    {% endfor %}    
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock content %}